<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title th:text="${pageTitle}">Color Run | Accueil</title>

  <!-- Police Poppins -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <script src="https://cdn.tailwindcss.com"></script>
  <!-- CSS Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

  <!-- JS Leaflet -->

</head>
<body class="bg-gray-50 text-gray-900 min-h-screen flex flex-col font-poppins">

<div th:replace="fragments/header :: headerFragment(page='home', member=${member})"></div>

<!-- Hero Section -->
<section class="bg-pink-500 text-white text-center py-8">
  <div class="container mx-auto px-4">
    <p class="mb-2">Venez vivre l'expérience unique de la Color run dans votre ville</p>
    <h1 class="text-3xl font-bold mb-4">Rejoignez un explosion de couleurs, de fun et d'énergie</h1>
    <p class="max-w-2xl mx-auto">La course qui est un véritable arc-en-ciel sur un parcours de 5 km. Chaque kilomètre devient un arc-en-ciel de bonheur. Que vous soyez coureur aguerri ou amateur de bonne humeur, vous êtes au bon endroit.</p>
  </div>
</section>

<!-- Search Courses Section -->
<section class="py-8 text-center">
  <div class="container mx-auto px-4">
    <h2 class="text-2xl font-bold text-teal-500 mb-6">Découvrez les courses près de chez vous !</h2>

    <div class="flex justify-center gap-2 mb-8">
      <input type="text" id="postal-code" placeholder="Code postal" class="border border-teal p-2 w-40">
      <select id="date-filter" class="border border-teal p-2 w-40">
        <option value="all">Toutes les dates</option>
        <option value="juin">Juin 2025</option>
        <option value="juillet">Juillet 2025</option>
      </select>
      <button id="search-button" class="bg-teal text-white px-4 py-2 rounded">Rechercher</button>
    </div>

    <!-- Google Maps -->
    <div id="map" class="h-96 w-full border rounded mb-8 relative shadow-md">
      <!-- La carte Google Maps sera chargée ici -->
      <div class="absolute inset-0 bg-gray-100 flex items-center justify-center z-0">
        <p class="text-gray-500">Chargement de la carte...</p>
      </div>

      <!-- Légende de la carte -->
      <div class="absolute bottom-4 left-4 bg-white p-3 rounded-md shadow-md z-10">
        <h4 class="font-bold text-sm mb-2">Légende</h4>
        <div class="flex items-center mb-1">
          <div class="w-4 h-4 rounded-full bg-pink-500 mr-2"></div>
          <p class="text-xs">Courses à venir</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Si vous voulez utiliser le fragment de carte à la place, décommentez cette ligne et commentez la section précédente -->
<!-- <div th:replace="fragments/map-standalone :: mapFragmentStandalone('100%', '500px', 6, true, true, 'mb-8')"></div> -->

<!-- Concept Section -->
<section class="bg-yellow-500 py-8">
  <div class="container mx-auto px-4">
    <h2 class="text-2xl font-bold mb-6 text-center">Découvrez le concept de la Color Run</h2>

    <div class="flex flex-wrap">
      <div class="w-full md:w-1/3 p-4">
        <!-- Placeholder for image -->
        <div class="bg-gray-200 h-48 w-full"></div>
      </div>
      <div class="w-full md:w-2/3 p-4">
        <p>La Color Run est une course accessible à tous, où le chrono n'a aucune importance. Laissez-vous emporter par une vague de couleurs à chaque kilomètre et terminez rayonnant dans une ambiance de fête. Une seule règle : partir blanc et finir complètement coloré.</p>
      </div>
    </div>
  </div>
</section>

<!-- Why Participate Section -->
<section class="py-8">
  <div class="container mx-auto px-4">
    <h2 class="text-2xl font-bold mb-6 text-center">Pourquoi participer ?</h2>

    <div class="flex flex-wrap justify-center gap-8">
      <div class="w-full md:w-1/4 text-center">
        <div class="bg-gray-200 h-32 w-32 mx-auto mb-4"></div>
        <h3 class="font-bold mb-2">Une ambiance fun et conviviale</h3>
      </div>

      <div class="w-full md:w-1/4 text-center">
        <div class="bg-gray-200 h-32 w-32 mx-auto mb-4"></div>
        <h3 class="font-bold mb-2">Aucune pression, juste du plaisir</h3>
      </div>

      <div class="w-full md:w-1/4 text-center">
        <div class="bg-gray-200 h-32 w-32 mx-auto mb-4"></div>
        <h3 class="font-bold mb-2">Accessible à tous les âges et niveaux</h3>
      </div>
    </div>
  </div>
</section>

<!-- Join Adventure Section -->
<section class="bg-pink-500 text-white py-8">
  <div class="container mx-auto px-4 flex flex-wrap items-center">
    <div class="w-full md:w-2/3">
      <h2 class="text-2xl font-bold mb-4">Rejoignez l'aventure !</h2>
      <p class="mb-4">Prêt à vivre une expérience unique ? Inscrivez-vous en quelques clics et préparez-vous à une journée mémorable. Voici ce que vous recevrez en participant :</p>
      <ul class="mb-4">
        <li>- Un kit de bienvenue comprenant un t-shirt blanc officiel, un dossard et des goodies colorés</li>
        <li>- Une médaille souvenir pour célébrer votre exploit</li>
        <li>- L'accès à l'after-party où musique et pluie colorée seront au rendez-vous</li>
      </ul>
      <p>Alors qu'attendez-vous ? Faites partie des milliers de coureurs qui partagent cette aventure incroyable.</p>

      <div class="flex gap-4 mt-6">
        <a href="/color_run_war/register" class="bg-white text-pink-500 px-4 py-2 rounded font-medium">S'inscrire maintenant</a>
        <a href="#" class="bg-transparent border border-white text-white px-4 py-2 rounded font-medium">En savoir plus sur l'inscription</a>
      </div>
    </div>

    <div class="w-full md:w-1/3 p-4">
      <!-- Placeholder for image -->
      <div class="bg-gray-200 h-48 w-full"></div>
    </div>
  </div>
</section>

<!-- Footer -->
<footer class="bg-white border-t p-4 mt-auto">
  <div class="container mx-auto px-4 text-center">
    <p class="text-sm text-gray-500">&copy; 2025 Color Run. Tous droits réservés.</p>
  </div>
</footer>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
  // Données des événements (normalement récupérées depuis un servlet)
  const colorRunEvents = [
    { id: 1, title: "The Color Run Paris", lat: 48.856614, lng: 2.352222, date: "6 juin 2025",
      description: "Une super journée très colorée en perspective! La color run passera par divers endroits emblématiques avant de finir dans une explosion de couleurs!" },
    { id: 2, title: "The Color Run Lyon", lat: 45.764043, lng: 4.835659, date: "20 juin 2025",
      description: "Venez courir dans les rues de Lyon et profiter d'une ambiance festive et colorée!" },
    { id: 3, title: "The Color Run Marseille", lat: 43.296482, lng: 5.369780, date: "4 juillet 2025",
      description: "Course en bord de mer avec une vue imprenable sur le Vieux Port. Préparez-vous pour une explosion de couleurs!" },
    { id: 4, title: "The Color Run Bordeaux", lat: 44.837789, lng: -0.579180, date: "18 juillet 2025",
      description: "Parcours au cœur du centre historique bordelais, avec un final géant sur les quais de la Garonne!" }
  ];

  let map;

  // Initialisation de la carte
  function initMap() {
    // Centrer sur la France
    map = L.map('map').setView([46.603354, 1.888334], 6); // Coordonnées de la France avec zoom

    // Ajouter le fond de carte
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    // Ajouter des marqueurs pour chaque course
    colorRunEvents.forEach(event => {
      addMarker(event);
    });

    // Initialiser le filtre de date
    if (document.getElementById('date-filter')) {
      document.getElementById('date-filter').addEventListener('change', function() {
        filterEvents(this.value);
      });
    }

    // Initialiser la recherche par code postal
    if (document.getElementById('search-button')) {
      document.getElementById('search-button').addEventListener('click', function() {
        const postalCode = document.getElementById('postal-code').value;
        searchByPostalCode(postalCode);
      });
    }
  }

  // Ajouter un marqueur pour un événement
  function addMarker(event) {
    const marker = L.marker([event.lat, event.lng]).addTo(map);

    marker.bindPopup(`
        <div style="font-family: 'Poppins', sans-serif; padding: 10px; max-width: 250px;">
          <h3 style="font-weight: bold; font-size: 16px; margin-bottom: 5px;">${event.title}</h3>
          <p style="font-size: 14px; margin-bottom: 5px;"><strong>Date:</strong> ${event.date}</p>
          <p style="font-size: 12px; margin-bottom: 10px;">${event.description}</p>
          <a href="/color_run_war/event?id=${event.id}"
             style="background-color: #FFCC00; color: black; padding: 6px 12px;
                    border-radius: 4px; text-decoration: none; display: inline-block;
                    font-size: 12px; text-align: center; font-weight: 500;">
            VOIR PLUS
          </a>
        </div>
      `);
  }

  // Filtrer les événements par date
  function filterEvents(month) {
    // Afficher tous les événements
    if (!month || month === 'all') {
      colorRunEvents.forEach((event, index) => {
        markers[index].setVisible(true);
      });
      return;
    }

    // Filtrer les événements selon la date
    colorRunEvents.forEach((event, index) => {
      const visible = event.date.includes(month);
      markers[index].setVisible(visible);
    });
  }

  // Rechercher par code postal
  function searchByPostalCode(postalCode) {
    if (!postalCode) {
      alert('Veuillez entrer un code postal');
      return;
    }

    // Simulation de la recherche
    alert('Recherche pour le code postal: ' + postalCode);

    // Centrer sur Paris pour l'exemple
    map.setView([48.856614, 2.352222], 10);
  }
</script>
<script type="module">

  var map = L.map('map').setView([46.603354, 1.888334], 6);  // Centrer la carte sur la France avec un zoom de 6

  // Ajouter le fond de carte
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
  }).addTo(map);

  const colorRunEvents = [
    { title: "The Color Run Paris", lat: 48.856614, lng: 2.352222, date: "6 juin 2025", description: "Une super journée..." },
    // Ajouter d'autres événements ici
  ];

  colorRunEvents.forEach(event => {
    L.marker([event.lat, event.lng]).addTo(map)
            .bindPopup(`<b>${event.title}</b><br>${event.date}<br>${event.description}`)
            .openPopup();
  });

</script>
</body>
</html>